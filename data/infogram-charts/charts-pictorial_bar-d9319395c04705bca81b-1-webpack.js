(window.webpackJsonp=window.webpackJsonp||[]).push([["infogram-charts/charts-pictorial_bar"],{vvQW:function(t,e,a){"use strict";a.r(e),a.d(e,"PictorialBar",(function(){return B}));var r=a("LvDl"),i=a.n(r),n=a("vBe5"),o=a("ziQ1"),l=a("+3eq"),c=a("x5YE"),s=a("VLlq"),h=a("v3rV"),u=a("ZHFg"),p=a("x+1q"),f=a("3y/1"),d=a("3UmV"),g=a("2YLo"),v=a("XKI8"),b=a("pYxU"),y=a("v4xw");function m(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function O(t,e,a){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(a):i.value}})(t,e,a||t)}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var S=function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=x(t);if(e){var i=x(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return j(this,a)}}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(j,t);var e,a,r,d=D(j);function j(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,j),d.call(this,t,"div")}return e=j,r=[{key:"getClassName",value:function(){return"PictorialBar"}}],(a=[{key:"render",value:function(){var t=this;this.detectDimensions();var e=this.options,a=this.root,r=new g.Renderer({instance:this}),i=this.getSheetData(),f=Object(p.default)(i),d=this.runtime={width:e.width,height:e.height,inanimate:Object(h.inanimated)(e),sheet:i,formatter:f},v={top:10,right:10,bottom:10,left:10,pictorial:1},y=this.prepareSheetData(i),m=y.data;this.sizeMultiplier=1,a.select(".igc-pictorial-bar-visual").remove();var w=d.svg=a.append("svg").attr("class","igc-pictorial-bar-visual");this.groupTagName="g",Object(s.default)(this,{width:e.width}),Object(b.DownloadButton)(this,e.style.legend);var O=Object(c.legendHelper)({instance:this});if(O&&O.chartType("pictorial-grid"),!this.sheetsNotFound()){var x=e.series.showText?m[0].text:"",j=this.createAnimationCounter(2),k=e.style.graph.item.value,S=d.width-v.left-v.right,D=d.height-v.top-v.bottom,B=d.height,P=this.setupBarText(x,y.colors,k),C={width:Math.round(S/2),height:Math.round(D)},T=parseInt(k["font-size"],10),M=this.drawBarText(P,C,v,T,!1,y.textLink),R=C.height-M.height;R>=0?P.styles({top:v.top+R/2+"px"}):(D+=Math.abs(R),B+=Math.abs(R)),M.width>0&&(S-=M.width+10);var A=i.categories.shapes;A.length||(A=this.defaults().shapes.map((function(t){return t.title}))),A=Object(u.availableShapesMetrics)(e.shapes)(A);var E=Object.values(A).reduce((function(t,e){return t.width=Math.max(t.width,e.bbox.width+v.pictorial),t.height=Math.max(t.height,e.bbox.height),t}),{width:0,height:0}),L=this.getValueSum(m),I=S/L/E.width,_=D/E.height,z=Math.min(I,_);A=this.initShapesScaled(A,z),E=Object.values(A).reduce((function(t,e){return t.width=Math.max(t.width,e.bbox.width+v.pictorial),t.height=Math.max(t.height,e.bbox.height),t}),{width:0,height:0});var N={cols:Math.min(L,Math.floor(S/E.width)),rows:1,cellMetrics:E};N.cellCount=N.rows*N.cols,N.colPosition=Object(o.scaleBand)().domain(Object(n.range)(0,N.cols)).range([0,S]).padding(0),N.rowPosition=Object(o.scaleBand)().domain(Object(n.range)(0,N.rows)).range([(D-E.height)/2,D]).padding(0),N.realNumbers=!1;var V=y.data=this.getShapeDataScattered(i,m,N,A,L);y.overlayData=this.getShapeGroupOverlayPaths(m,V,N),this.prepareShapes(A,z);var H={igc:{x:v.left,y:v.top}};this.containerSetup(),w.attr("width",d.width).attr("height",B);var Q=w.select(".igc");r.add((function(){w.datum(t).transition().ease(l[e.animation.ease]).duration(e.animation.duration).on("start",(function(){t.events.call("startAnimation")})).on("end",(function(){j()})),Q.attr("transform","translate(".concat(H.igc.x,", ").concat(H.igc.y,")"))})),r.addGraph([{graphs:[y],transitionDuration:e.animation.duration,legend:O,originalScale:z,animationEnd:j}]),r.start()}}},{key:"prepareSheetData",value:function(t){var e=t.categories.shapes,a=this.getSheetColors(),r=t.series[0],i="".concat(r.rawData[0]),n=-1!==Object(f.replaceBlank)(i).indexOf("%"),o={value:Object(f.replaceBlank)(Math.abs(r.data[0]),0),valueLabel:Object(f.replaceBlank)(r.rawData[3]),category:Object(f.replaceBlank)(r.rawData[2]),text:Object(f.replaceBlank)(r.rawData[3]),shape:e[0],categoryIdx:0,link:r.links?r.links[0]:null},l={value:Object(f.replaceBlank)(Math.abs(r.data[1]),0),valueLabel:Object(f.replaceBlank)(r.rawData[3]),category:Object(f.replaceBlank)(""),shape:e[0],categoryIdx:1,link:r.links?r.links[1]:null};return n?(o.value=l.value*(o.value/100),l.value-=o.value):o.value>l.value?l.value=0:(o.value=l.value-(l.value-o.value),l.value-=o.value),Object(c.createLegendData)(this)({color:a[0],title:o.category,groupId:0}),o.value===l.value&&0===o.value&&(l.value=1),{type:r.type,data:[o,l],colors:a,textLink:r.links?r.links[3]:null}}},{key:"getSheetColors",value:function(){var t=this.runtime,e=i.a.get(t,"sheet"),a=i.a.get(e,"categories"),r=i.a.get(e,"series[0].index",0),n=a.inactiveColor,o=a.inactiveColorAlpha;return void 0!==o&&(n=y.Colors.rgbStrToRgbaStr(n,o)),[i.a.get(a,"colors[".concat(r,"]")),n]}},{key:"initShapesScaled",value:function(t,e){return Object.keys(t).reduce((function(a,r){var i=t[r].shape,n=Object(f.measurePath)(i,e);return a[r]={shape:i,bbox:n},a}),{})}},{key:"prepareShapes",value:function(t,e){var a=this.runtime.svg;a.selectAll("defs").data([0]).enter().append("defs");var r=a.select("defs");Object.keys(t).forEach((function(a){var i=t[a],n=i.shape,o=i.fillRule,l="igc-cp-"+a+this.chartId;r.selectAll("#"+l).data([0]).enter().append("clipPath").attr("id",l).selectAll("path").data([0]).enter().append("path").attr("d",n).attr("fill-rule",o),r.selectAll("#"+l).attr("transform","scale("+e+")")}),this)}},{key:"graphInstanceSetup",value:function(t,e,a,r,i){var n=e.data.length,o=this.runtime.formatter,l=Object(h.removeDelay)(this,(function(t,e){return e/n*500}));t.data(e.data).overlayData(e.overlayData).colors(e.colors).groupId(i).highlightFirstOnly(!0).tooltip(Object(v.createStyledTooltip)(this)).tooltipText((function(t){return t.category})).tooltipValue((function(t){return o.tooltip.x.format(t.valueLabel)})).transitionDelay(l).transitionDuration(r.transitionDuration),t.dispatch().on("animationEnd",r.animationEnd)}},{key:"setupBarText",value:function(t,e,a){var r=this.root,n=this.options.style.graph.item.value;r.select(".igc-pictorial-bar-text-container").remove();var o=r.insert("div",".igc-pictorial-bar-visual").attr("class",".igc-pictorial-bar-text-container".slice(1));o.styles({width:"".concat(this.runtime.width,"px")});var l=i.a.pick(a,["font-family","font-weight","font-style"]);return o.append("div").attr("class","igc-pictorial-bar-text").text(t).styles(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),r.forEach((function(e){w(t,e,a[e])}))}return t}({position:"absolute",color:n.color||e[0]},l))}},{key:"drawBarText",value:function(t,e,a,r,i,n){var o=this.interaction;t.styles({"font-size":"".concat(r,"px"),top:"".concat(a.top,"px"),right:"".concat(a.right,"px")}),t.style("width",null),i&&t.style("width","".concat(e.width,"px"));var l={width:t.node().offsetWidth,height:t.node().offsetHeight};return l.width>e.width?this.drawBarText(t,e,a,r,!0,n):l.height>e.height&&r>11?(r--,this.drawBarText(t,e,a,r,!1,n)):(t.classed("igc-chart-link",!!n).on("click",(function(){Object(f.openUrl)(n,o)})),l)}},{key:"containerSetup",value:function(){var t=this.runtime.svg;t.selectAll("defs").data([0]).enter().append("defs");var e=t.selectAll(".igc").data([0]);e.merge(e.enter().append("g").attr("class","igc"))}},{key:"defaults",value:function(){var t={};return i.a.merge(t,O(x(j.prototype),"defaults",this).call(this),{style:{graph:{item:{value:{"font-size":"60px"}}}}}),i.a.unset(t,"style.graph.item.value.color"),t}},{key:"emptySheetData",value:function(){return i.a.merge({},O(x(j.prototype),"emptySheetData",this).call(this),{categories:{inactiveColor:"#959595"}})}},{key:"applySheetOptions",value:function(t){t&&this.options.sheets.forEach((function(e,a){var r=function(e){return t[e]||t[0]}(a+1);r.categories&&i.a.merge(e.categories,r.categories),e.series.forEach((function(t){"bar"===t.type&&r.bar&&i.a.merge(t,r.bar)})),r.legend&&i.a.merge(e.legend,r.legend),e.iconSizeMultiplier=1}))}}])&&m(e.prototype,a),r&&m(e,r),j}(d.PictorialGrid)},"w+Xm":function(t,e,a){"use strict";a.r(e);var r=a("LvDl"),i=a.n(r),n=a("3y/1"),o=a("vvQW"),l=a("l7Rd"),c=a("6jAQ"),s=a("BD53"),h=Object.create(c.default);e.default=h,function(){this.instanceClass=o.PictorialBar,this.defaultHeight=100,this.setupChartOptions=function(){c.default.setupChartOptions.call(this);var t=this.custom;this.chartOptions.series.showText=!i.a.has(t,"showText")||t.showText},this.setupChartOptionsStyle=function(){c.default.setupChartOptionsStyle.call(this);var t=i.a.merge({},Object(n.kebabizeObject)(i.a.get(this.charts,"pictorialBar.style",{}))),e=i.a.get(this,"custom.labels.graph.item.value.font-family"),a=i.a.get(t,"graph.item.value.font-family");e?i.a.unset(t,"graph.item.value.font-family"):a&&i.a.set(t,"graph.item.value.font-family",a),i.a.merge(this.chartOptions.style,t)},this.setupChartSheetOptionsItem=function(t){var e=i.a.get(this,"charts.pictorialBar.colors.background"),a=t.inactive||e||"#959595",r={categories:{colors:i.a.merge([],this.themeColors,t.colors||this.colors),inactiveColor:a,inactiveColorAlpha:i.a.get(t,"inactiveAlpha",1)}};Object(s.default)(r,t,this.charts);var n=t.path;return l.addShapesToCharts.call(this,n),r.categories.shapes=[Object(l.cleanShapeName)(n)],r}}.call(h)}}]);